Feature: 用户注册
  作为一个新用户
  我想要能够注册账户
  以便使用系统服务

  Background:
    Given 系统已经启动
    And 数据库已经初始化

  Scenario: 请求验证码时手机号格式无效
    Given 用户在注册页面
    When 用户输入一个无效的手机号"123"并点击"获取验证码"
    Then 系统不发送验证码
    And 页面提示"请输入正确的手机号码"

  Scenario: 成功获取验证码
    Given 用户在注册页面
    When 用户输入一个格式正确的手机号"13900139000"并点击"获取验证码"
    Then 系统为该手机号生成一个6位验证码并打印在控制台
    And "获取验证码"按钮进入60秒倒计时且不可点击
    And 数据库记录手机号和验证码，有效期为60秒

  Scenario: 使用已注册的手机号进行注册
    Given 一个手机号"13800138000"已被注册
    And 用户在注册页面
    When 用户使用该手机号和正确的验证码点击"注册"
    Then 系统不创建新用户
    And 页面提示"该手机号已注册，将直接为您登录"
    And 用户成功登录并跳转到首页

  Scenario: 未同意用户协议时注册按钮的状态
    Given 用户在注册页面输入了手机号和验证码
    When 用户未勾选"同意《淘贝用户协议》"复选框
    Then "注册"按钮为不可点击状态
    When 用户勾选"同意《淘贝用户协议》"复选框
    Then "注册"按钮变为可点击状态

  Scenario: 成功注册
    Given 用户在注册页面
    When 用户输入未注册的手机号"13700137000"和正确的验证码，勾选协议并点击"注册"
    Then 系统在数据库中创建新用户
    And 页面提示"注册成功"
    And 用户成功登录并自动跳转到首页