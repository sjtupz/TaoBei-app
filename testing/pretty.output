功能: 用户登录 # features/login.feature:2
  作为一个用户
  我想要能够登录系统
  以便访问我的账户
  功能: 用户登录  # features/login.feature:2

  场景: 请求验证码时手机号格式无效                    # features/login.feature:11
    假如 系统已经启动                          # features/steps/login_steps.py:13
    并且 数据库已经初始化                        # features/steps/login_steps.py:20
    假如 用户在登录页面                         # features/steps/login_steps.py:28
    当 用户在登录页面输入一个无效的手机号"123"并点击"获取验证码" # features/steps/login_steps.py:73
    那么 系统不发送验证码                        # features/steps/login_steps.py:160
      Traceback (most recent call last):
        File "d:\Project\taobei-app\.venv\Lib\site-packages\behave\model.py", line 1991, in run
          match.run(runner.context)
          ~~~~~~~~~^^^^^^^^^^^^^^^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\behave\matchers.py", line 105, in run
          self.func(context, *args, **kwargs)
          ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "features\steps\login_steps.py", line 165, in step_system_does_not_send_verification_code
          assert get_code_button.is_enabled(), "获取验证码按钮应该仍然可点击"
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\sync_api\_generated.py", line 17142, in is_enabled
          self._sync(self._impl_obj.is_enabled(timeout=timeout))
          ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\_impl\_sync_base.py", line 115, in _sync
          return task.result()
                 ~~~~~~~~~~~^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\_impl\_locator.py", line 498, in is_enabled
          return await self._frame.is_enabled(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          ...<3 lines>...
          )
          ^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\_impl\_frame.py", line 398, in is_enabled
          return await self._channel.send(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^
              "isEnabled", self._timeout, locals_to_params(locals())
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          )
          ^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
          return await self._connection.wrap_api_call(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          ...<3 lines>...
          )
          ^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 558, in wrap_api_call
          raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
      playwright._impl._errors.TimeoutError: Locator.is_enabled: Timeout 30000ms exceeded.
      Call log:
        - waiting for locator("[data-testid=\"get-verification-code-btn\"]")

    并且 页面提示"请输入正确的手机号码"                # None
----
CAPTURED STDOUT: before_scenario
=== before_scenario 被调用 ===
开始执行场景: 请求验证码时手机号格式无效
浏览器已初始化: True
浏览器上下文已初始化: True
页面驱动已初始化: True
----
CAPTURED STDOUT: after_scenario
场景执行完成: 请求验证码时手机号格式无效
----
CAPTURED STDOUT: scenario
系统已启动
数据库已初始化
用户输入无效手机号: 123
---- CAPTURED_SCENARIO_OUTPUT_END ----

  场景: 成功获取验证码                                    # features/login.feature:17
    假如 系统已经启动                                    # features/steps/login_steps.py:13
    并且 数据库已经初始化                                  # features/steps/login_steps.py:20
    假如 用户在登录页面                                   # features/steps/login_steps.py:28
    当 用户在登录页面输入一个格式正确的手机号"13800138000"并点击"获取验证码" # features/steps/login_steps.py:82
    那么 系统为该手机号生成一个6位验证码并打印在控制台                   # features/steps/register_steps.py:191
    并且 "获取验证码"按钮进入60秒倒计时且不可点击                    # features/steps/register_steps.py:203
      Traceback (most recent call last):
        File "d:\Project\taobei-app\.venv\Lib\site-packages\behave\model.py", line 1991, in run
          match.run(runner.context)
          ~~~~~~~~~^^^^^^^^^^^^^^^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\behave\matchers.py", line 105, in run
          self.func(context, *args, **kwargs)
          ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "features\steps\register_steps.py", line 207, in step_get_code_button_countdown_register
          is_disabled = context.register_page.is_get_code_button_disabled()
                        ^^^^^^^^^^^^^^^^^^^^^
        File "d:\Project\taobei-app\.venv\Lib\site-packages\behave\runner.py", line 430, in __getattr__
          raise AttributeError(msg)
      AttributeError: 'Context' object has no attribute 'register_page'

    并且 数据库记录手机号和验证码，有效期为60秒                      # None
----
CAPTURED STDOUT: before_scenario
=== before_scenario 被调用 ===
开始执行场景: 成功获取验证码
浏览器已初始化: True
浏览器上下文已初始化: True
页面驱动已初始化: True
----
CAPTURED STDOUT: after_scenario
场景执行完成: 成功获取验证码
----
CAPTURED STDOUT: scenario
系统已启动
数据库已初始化
用户输入有效手机号: 13800138000，已创建验证码: 123456
生成验证码: 123456
---- CAPTURED_SCENARIO_OUTPUT_END ----

  场景: 使用未注册的手机号登录               # features/login.feature:24
    假如 系统已经启动                   # features/steps/login_steps.py:13
    并且 数据库已经初始化                 # features/steps/login_steps.py:20
    假如 一个手机号"13900139000"未被注册   # features/steps/login_steps.py:55
    并且 用户在登录页面                  # features/steps/login_steps.py:28
    当 用户使用该未注册的手机号和正确的验证码点击"登录" # features/steps/login_steps.py:103
    那么 系统不让用户登录                 # features/steps/login_steps.py:295
    并且 页面提示"该手机号未注册，请先完成注册"     # features/steps/login_steps.py:169

  场景: 使用错误的验证码登录                    # features/login.feature:31
    假如 系统已经启动                       # features/steps/login_steps.py:13
    并且 数据库已经初始化                     # features/steps/login_steps.py:20
    假如 一个手机号"13800138000"已被注册       # features/steps/login_steps.py:64
    并且 用户在登录页面                      # features/steps/login_steps.py:28
    当 用户使用该手机号和错误的验证码"000000"点击"登录" # features/steps/login_steps.py:125
    那么 系统不让用户登录                     # features/steps/login_steps.py:295
    并且 页面提示"验证码错误"                  # features/steps/login_steps.py:169

  场景: 成功登录                    # features/login.feature:38
    假如 系统已经启动                 # features/steps/login_steps.py:13
    并且 数据库已经初始化               # features/steps/login_steps.py:20
    假如 一个手机号"13800138000"已被注册 # features/steps/login_steps.py:64
    并且 用户在登录页面                # features/steps/login_steps.py:28
    当 用户使用该手机号和正确的验证码点击"登录"   # features/steps/login_steps.py:137
    那么 系统验证成功                 # features/steps/login_steps.py:303
    并且 页面提示"登录成功"             # features/steps/login_steps.py:169
    并且 页面自动跳转到首页              # features/steps/login_steps.py:311

